<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Home Content - Interia Decor</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../../assets/css/admin.css">
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar (same as dashboard.html) -->
    <div class="admin-sidebar">
      <div class="sidebar-header">
        <img src="../../assets/images/logo-white.png" alt="Interia Decor">
        <h3>Admin Panel</h3>
      </div>
      <ul class="sidebar-nav">
        <li><a href="../dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
        <li>
          <a href="#content-collapse" data-bs-toggle="collapse" class="active">
            <i class="fas fa-edit"></i> Content <i class="fas fa-chevron-down"></i>
          </a>
          <ul class="collapse show" id="content-collapse">
            <li class="active"><a href="content-home.html">Home Page</a></li>
            <li><a href="content-projects.html">Projects</a></li>
            <li><a href="content-testimonials.html">Testimonials</a></li>
            <li><a href="content-services.html">Services</a></li>
          </ul>
        </li>
        <li><a href="settings-design.html"><i class="fas fa-palette"></i> Design Settings</a></li>
        <li><a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
      </ul>
    </div>
    
    <!-- Main Content -->
    <div class="admin-main">
      <div class="admin-header">
        <h2>Home Page Content</h2>
        <div class="user-info">
          <span>Welcome, Admin</span>
        </div>
      </div>
      
      <div class="admin-content">
        <div class="form-card">
          <h3>Hero Section</h3>
          <form id="hero-form">
            <div class="form-group">
              <label for="hero-title" class="form-label">Title</label>
              <input type="text" class="form-control" id="hero-title" name="title" required>
            </div>
            <div class="form-group">
              <label for="hero-subtitle" class="form-label">Subtitle</label>
              <input type="text" class="form-control" id="hero-subtitle" name="subtitle" required>
            </div>
            <div class="form-group">
              <label for="hero-button-text" class="form-label">Button Text</label>
              <input type="text" class="form-control" id="hero-button-text" name="buttonText" required>
            </div>
            <div class="form-group">
              <label for="hero-image" class="form-label">Background Image</label>
              <input type="file" class="form-control" id="hero-image" name="image" accept="image/*">
              <small class="text-muted">Recommended size: 1920x1080px</small>
            </div>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </form>
        </div>
        
        <div class="form-card mt-4">
          <h3>About Preview Section</h3>
          <form id="about-form">
            <div class="form-group">
              <label for="about-summary" class="form-label">Summary Text</label>
              <textarea class="form-control" id="about-summary" name="summary" rows="3" required></textarea>
            </div>
            <div class="form-group">
              <label for="about-image" class="form-label">Preview Image</label>
              <input type="file" class="form-control" id="about-image" name="image" accept="image/*">
            </div>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </form>
        </div>
        
        <div class="form-card mt-4">
          <h3>Featured Content</h3>
          <div class="table-responsive">
            <table class="table crud-table" data-endpoint="home-content">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Section</th>
                  <th>Title</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="featured-content-table">
                <!-- Content loaded via JS -->
              </tbody>
            </table>
          </div>
          <button class="btn btn-success mt-3" data-bs-toggle="modal" data-bs-target="#addContentModal">
            <i class="fas fa-plus"></i> Add New Content
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Content Modal -->
  <div class="modal fade" id="addContentModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add New Content</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="add-content-form">
            <div class="form-group">
              <label for="content-section" class="form-label">Section</label>
              <select class="form-select" id="content-section" name="section" required>
                <option value="">Select Section</option>
                <option value="services">Services</option>
                <option value="projects">Projects</option>
                <option value="testimonials">Testimonials</option>
              </select>
            </div>
            <div class="form-group">
              <label for="content-title" class="form-label">Title</label>
              <input type="text" class="form-control" id="content-title" name="title" required>
            </div>
            <div class="form-group">
              <label for="content-description" class="form-label">Description</label>
              <textarea class="form-control" id="content-description" name="description" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="save-content-btn">Save Content</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../../assets/js/admin/auth.js"></script>
  <script src="../../assets/js/admin/crud.js"></script>
  <script src="../../assets/js/admin/dashboard.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
      // Load current content
      const homeContent = await postsCRUD.getAll();
      
      if (homeContent.hero) {
        populateForm('hero-form', homeContent.hero);
      }
      
      if (homeContent.about) {
        populateForm('about-form', homeContent.about);
      }
      
      // Form submissions
      document.getElementById('hero-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const formData = getFormData('hero-form');
        await postsCRUD.update('hero', formData);
        showAlert('Hero section updated successfully!', 'success');
      });
      
      document.getElementById('about-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const formData = getFormData('about-form');
        await postsCRUD.update('about', formData);
        showAlert('About section updated successfully!', 'success');
      });
      
      // Initialize content table
      loadContentTable();
    });
    
    async function loadContentTable() {
      const homeContent = await postsCRUD.getAll();
      const tableBody = document.getElementById('featured-content-table');
      
      if (!homeContent.featured || !tableBody) return;
      
      tableBody.innerHTML = homeContent.featured.map(item => `
        <tr>
          <td>${item.id}</td>
          <td>${capitalize(item.section)}</td>
          <td>${item.title}</td>
          <td class="table-actions">
            <a href="#" class="edit" data-id="${item.id}"><i class="fas fa-edit"></i></a>
            <a href="#" class="delete" data-id="${item.id}"><i class="fas fa-trash"></i></a>
          </td>
        </tr>
      `).join('');
    }
    
    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }
  </script>
</body>
</html>